import {jsObj} from './prop';
import * as namespace from './prop';

class Base {
    get prop() { return 1; }
    get prop2() { return 1; }
    get prop3() { return 1; }
    get prop4() { return 1; }
    get prop5() { return 1; }
    set prop5(_) {}
    get [name]() { return 1; }
    get [Symbol.toStringTag]() {return 'A'};
}

abstract class AbstractDerived extends Base {
    prop = 1;
    ~~~~      [error no-unsafe-property-override: Overriding readonly property 'prop' might fail at runtime.]
}

class Incomplete extends implements Object {
    prop = 1;
}

class Implements implements Base {
    prop: number;
    prop2: number;
    prop3: number;
    prop4: number;
    prop5: number;
    [Symbol.toStringTag]: string;
}

const prop4 = 'prop4';
export class Derived extends Base {
    prop = 1;
    ~~~~      [error no-unsafe-property-override: Overriding readonly property 'prop' might fail at runtime.]
    'prop2' = 1;
    ~~~~~~~      [error no-unsafe-property-override: Overriding readonly property ''prop2'' might fail at runtime.]
    'prop3' = 1;
    ~~~~~~~      [error no-unsafe-property-override: Overriding readonly property ''prop3'' might fail at runtime.]
    [prop4] = 1;
    ~~~~~~~      [error no-unsafe-property-override: Overriding readonly property '[prop4]' might fail at runtime.]
    prop5 = 1;
    [name] = 1;
    [Symbol.toStringTag] = 'B';
    ~~~~~~~~~~~~~~~~~~~~        [error no-unsafe-property-override: Overriding readonly property '[Symbol.toStringTag]' might fail at runtime.]
}

/** @class */ class Derived2 extends ((): new () => Readonly<Record<'foo', number>> => undefined!)() {
    foo = 1;
    ~~~      [error no-unsafe-property-override: Overriding readonly property 'foo' might fail at runtime.]
}

class Derived3 extends ((): new () => {readonly [K in 'bar']: number} => undefined!)() {
    bar = 1;
    ~~~      [error no-unsafe-property-override: Overriding readonly property 'bar' might fail at runtime.]
}

type Mutable<T> = {-readonly [K in keyof T]: T[K]};

class Derived4 extends ((): new () => Mutable<Readonly<Record<'baz', number>>> => undefined!)() {
    baz = 1;
}
class Derived4_1 extends ((): new () => Mutable<{readonly baz: number}> => undefined!)() {
    baz = 1;
}

class Derived5 extends ((): new () => Pick<Readonly<Record<'bas', number>>, 'bas'> => undefined!)() {
    bas = 1;
    ~~~      [error no-unsafe-property-override: Overriding readonly property 'bas' might fail at runtime.]
}

class Derived6 extends ((): new () => Partial<Readonly<Record<'foo', number>>> & Pick<Readonly<{bar: number} & {baz: number}>, 'baz'> => undefined!)() {
    foo = 1;
    ~~~      [error no-unsafe-property-override: Overriding readonly property 'foo' might fail at runtime.]
    bar = 1;
    baz = 1;
    ~~~      [error no-unsafe-property-override: Overriding readonly property 'baz' might fail at runtime.]
}

const obj = {const: 1 + 1} as const;

class Derived7 extends ((): new() => typeof obj => undefined!)() {
    const = 1;
    ~~~~~      [error no-unsafe-property-override: Overriding readonly property 'const' might fail at runtime.]
}
class Derived7_1 extends ((): new() => Mutable<typeof obj> => undefined!)() {
    const = 1;
}

class Derived8 extends ((): new() => readonly [number, string] => undefined!)() {
    0 = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property '0' might fail at runtime.]
}
class Derived8_1 extends ((): new() => Pick<readonly [number, number], 1> => undefined!)() {
    1 = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property '1' might fail at runtime.]
}

class Derived9 extends ((): new () => Pick<{readonly [K: string]: number} | {prop: number}, 'prop'> => undefined!)() {
    prop = 1;
    ~~~~      [error no-unsafe-property-override: Overriding readonly property 'prop' might fail at runtime.]
}

class TsClass extends ((): new() => typeof jsObj => undefined!)() {
    a = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property 'a' might fail at runtime.]
    b = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property 'b' might fail at runtime.]
    c = 1;
    d = 1;
    e = 1;
    f = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property 'f' might fail at runtime.]
}

class Derived10 extends ((): new () => typeof namespace => undefined!)() {
    jsObj: any;
    ~~~~~       [error no-unsafe-property-override: Overriding readonly property 'jsObj' might fail at runtime.]
}

namespace namespace2 {
    export const v: number = 1;
}

class Derived10_1 extends ((): new () => typeof namespace2 => undefined!)() {
    v = 1;
    ~      [error no-unsafe-property-override: Overriding readonly property 'v' might fail at runtime.]
}
